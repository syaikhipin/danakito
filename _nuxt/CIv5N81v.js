const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LRf28HWw.js","./entry.BGwMWRPr.css"])))=>i.map(i=>d[i]);
import{e as M,r as v,g as S,z,_ as y,h,A as I,c as i,a as c,s as $,i as x,B as A,y as m,o as l,C as V}from"./LRf28HWw.js";import{_ as B}from"./DlAUqK2U.js";const N={class:"h-full w-full relative"},F={class:"absolute top-4 right-16 bg-white/90 rounded-lg shadow-lg px-4 py-3 z-[1002] min-w-[240px]"},U={key:0},j={key:1},H={key:2},R={key:3},G={key:0,class:"absolute inset-0 bg-white/80 flex items-center justify-center z-10"},J=M({__name:"InvestmentMap",props:{heatmapType:{},mobilityData:{},spendingData:{},opportunityData:{},demographicsData:{},initialCenter:{},initialZoom:{},showCenterMarker:{type:Boolean}},emits:["area-selected","map-ready"],setup(b,{emit:k}){const s=b,f=k,g=v(),t=v(),d=v(!0),p=v();S(()=>{z(()=>{_()})});const _=async()=>{if(g.value)try{const e=await y(()=>import("./LRf28HWw.js").then(a=>a.l),__vite__mapDeps([0,1]),import.meta.url),o=await y(()=>import("./LRf28HWw.js").then(a=>a.aa),__vite__mapDeps([0,1]),import.meta.url);delete e.default.Icon.Default.prototype._getIconUrl,e.default.Icon.Default.mergeOptions({iconRetinaUrl:"/marker-icon-2x.png",iconUrl:"/marker-icon.png",shadowUrl:"/marker-shadow.png"}),t.value=e.default.map(g.value,{center:s.initialCenter||[40.7128,-74.006],zoom:s.initialZoom||12,zoomControl:!1}),e.default.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:18}).addTo(t.value),e.default.control.zoom({position:"bottomright"}).addTo(t.value),s.showCenterMarker&&s.initialCenter&&e.default.marker(s.initialCenter).addTo(t.value).bindPopup("Analysis Location").openPopup(),O(e.default),d.value=!1,f("map-ready"),console.log("🗺️ Map initialized successfully at NYC coordinates")}catch(e){console.error("Error initializing map:",e),d.value=!1}},O=e=>{if(t.value)try{p.value=new e.FeatureGroup,t.value.addLayer(p.value);const o=new e.Control.Draw({position:"topright",draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Error:</strong> shape edges cannot cross!"},shapeOptions:{color:"#3b82f6",weight:2,fillOpacity:.2}},rectangle:{shapeOptions:{color:"#3b82f6",weight:2,fillOpacity:.2}},circle:{shapeOptions:{color:"#3b82f6",weight:2,fillOpacity:.2}},marker:{icon:new e.Icon({iconUrl:"/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41]})},polyline:!1,circlemarker:!1},edit:{featureGroup:p.value,remove:!0}});t.value.addControl(o),t.value.on(e.Draw.Event.CREATED,a=>{var u;const n=a.layer;(u=p.value)==null||u.addLayer(n);const r=n.toGeoJSON();f("area-selected",r),console.log("✏️ Area drawn and selected")}),t.value.on(e.Draw.Event.EDITED,a=>{a.layers.eachLayer(r=>{const u=r.toGeoJSON();f("area-selected",u)})}),t.value.on(e.Draw.Event.DELETED,()=>{console.log("🗑️ Drawing deleted")}),console.log("✏️ Drawing tools initialized")}catch(o){console.error("Error initializing drawing tools:",o)}},D=()=>{if(t.value)try{const e=window.L||window.leaflet;if(!e)return;[{lat:40.7589,lng:-73.9851,intensity:.8},{lat:40.7505,lng:-73.9934,intensity:.9},{lat:40.7061,lng:-74.0087,intensity:.7},{lat:40.7829,lng:-73.9654,intensity:.6},{lat:40.6892,lng:-74.0445,intensity:.5}].forEach(a=>{const n=e.circleMarker([a.lat,a.lng],{radius:Math.max(8,a.intensity*20),fillColor:w(a.intensity),color:w(a.intensity),weight:2,opacity:.7,fillOpacity:.5});n.bindPopup(`
        <div class="p-2">
          <h4 class="font-semibold text-sm">Investment Opportunity</h4>
          <p class="text-xs">Score: ${(a.intensity*100).toFixed(1)}%</p>
          <p class="text-xs">Location: ${a.lat.toFixed(4)}, ${a.lng.toFixed(4)}</p>
        </div>
      `),n.addTo(t.value)}),console.log("📊 Sample heatmap data added")}catch(e){console.error("Error adding sample heatmap:",e)}},w=e=>e<.2?"#3b82f6":e<.4?"#06b6d4":e<.6?"#10b981":e<.8?"#f59e0b":"#ef4444";h(()=>d.value,e=>{!e&&t.value&&setTimeout(()=>{D()},1e3)}),I(()=>{t.value&&t.value.remove()}),h(()=>s.heatmapType,(e,o)=>{t.value&&(C(),e==="mobility"?T():e==="spending"?L():e==="opportunity"?E():e==="demographics"&&P())});function C(){t.value&&t.value._overlays&&(t.value._overlays.forEach(e=>t.value.removeLayer(e)),t.value._overlays=[]),window._danakitoOverlays&&(window._danakitoOverlays.forEach(e=>t.value.removeLayer(e)),window._danakitoOverlays=[])}function T(){if(!t.value)return;const e=window.L||window.leaflet;if(!e)return;const o=s.mobilityData||[];window._danakitoOverlays=o.map(a=>{const n=e.circleMarker([a.lat,a.lng],{radius:Math.max(8,a.intensity*20),fillColor:"#3b82f6",color:"#3b82f6",weight:2,opacity:.7,fillOpacity:.5}).addTo(t.value);return n.on("click",()=>{n.bindPopup(`<b>Foot Traffic:</b> ${a.intensity}`).openPopup()}),n})}function L(){if(!t.value)return;const e=window.L||window.leaflet;if(!e)return;const o=s.spendingData||[];window._danakitoOverlays=o.map(a=>{const n=e.rectangle([[a.lat-.002,a.lng-.002],[a.lat+.002,a.lng+.002]],{color:"#f59e42",weight:2,fillColor:"#f59e42",fillOpacity:.5}).addTo(t.value);return n.on("click",()=>{n.bindPopup(`<b>Transaction Volume:</b> $${a.amount}`).openPopup()}),n})}function E(){if(!t.value)return;const e=window.L||window.leaflet;if(!e)return;const o=s.opportunityData||[];window._danakitoOverlays=o.map(a=>{const n=e.marker([a.lat,a.lng],{title:`Opportunity Score: ${a.score}`}).addTo(t.value);return n.on("click",()=>{n.bindPopup(`<b>Opportunity Score:</b> ${a.score}`).openPopup()}),n})}function P(){if(!t.value)return;const e=window.L||window.leaflet;if(!e)return;const o=s.demographicsData||[];window._danakitoOverlays=o.map(a=>{const n=a.population/5e3,r=e.circleMarker([a.lat,a.lng],{radius:Math.max(6,n*15),fillColor:n>.6?"#8b5cf6":"#c4b5fd",color:"#6d28d9",weight:1,opacity:.8,fillOpacity:.6}).addTo(t.value);return r.on("click",()=>{r.bindPopup(`<b>Population:</b> ${a.population}<br><b>Avg. Income:</b> $${a.avgIncome.toLocaleString()}`).openPopup()}),r})}return(e,o)=>(l(),i("div",N,[c("div",{id:"map",ref_key:"mapContainer",ref:g,class:"h-full w-full"},null,512),$(c("div",F,[s.heatmapType==="mobility"?(l(),i("div",U,o[0]||(o[0]=[m('<div class="font-bold text-blue-700 mb-1" data-v-79c582c0>Mobility Data</div><div class="flex items-center space-x-2 mb-1" data-v-79c582c0><span class="inline-block w-5 h-5 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs" data-v-79c582c0><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-79c582c0><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V7a4 4 0 10-8 0v9m8 0a4 4 0 108 0V7a4 4 0 10-8 0v9z" data-v-79c582c0></path></svg></span><span class="text-sm text-gray-700" data-v-79c582c0>High Foot Traffic</span></div><div class="flex items-center space-x-2" data-v-79c582c0><span class="inline-block w-5 h-5 rounded bg-blue-200 border border-blue-400" data-v-79c582c0></span><span class="text-sm text-gray-700" data-v-79c582c0>Low Foot Traffic</span></div>',3)]))):s.heatmapType==="spending"?(l(),i("div",j,o[1]||(o[1]=[m('<div class="font-bold text-orange-700 mb-1" data-v-79c582c0>Spending Patterns</div><div class="flex items-center space-x-2 mb-1" data-v-79c582c0><span class="inline-block w-5 h-5 bg-orange-500 flex items-center justify-center text-white text-xs" data-v-79c582c0><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-79c582c0><text x="2" y="15" font-size="14" font-family="Arial" fill="white" data-v-79c582c0>$</text></svg></span><span class="text-sm text-gray-700" data-v-79c582c0>High Transaction Volume</span></div><div class="flex items-center space-x-2" data-v-79c582c0><span class="inline-block w-5 h-5 bg-orange-200 border border-orange-400" data-v-79c582c0></span><span class="text-sm text-gray-700" data-v-79c582c0>Low Transaction Volume</span></div>',3)]))):s.heatmapType==="opportunity"?(l(),i("div",H,o[2]||(o[2]=[m('<div class="font-bold text-green-700 mb-1" data-v-79c582c0>Investment Opportunities</div><div class="flex items-center space-x-2 mb-1" data-v-79c582c0><span class="inline-block w-5 h-5 text-green-600 flex items-center justify-center" data-v-79c582c0><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20" data-v-79c582c0><polygon points="10,2 12,8 18,8 13,12 15,18 10,14 5,18 7,12 2,8 8,8" data-v-79c582c0></polygon></svg></span><span class="text-sm text-gray-700" data-v-79c582c0>High Opportunity Score</span></div><div class="flex items-center space-x-2" data-v-79c582c0><span class="inline-block w-5 h-5 text-green-400 flex items-center justify-center" data-v-79c582c0><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20" data-v-79c582c0><polygon points="10,2 12,8 18,8 13,12 15,18 10,14 5,18 7,12 2,8 8,8" data-v-79c582c0></polygon></svg></span><span class="text-sm text-gray-700" data-v-79c582c0>Moderate Opportunity</span></div>',3)]))):s.heatmapType==="demographics"?(l(),i("div",R,o[3]||(o[3]=[m('<div class="font-bold text-purple-700 mb-1" data-v-79c582c0>Demographics</div><div class="flex items-center space-x-2 mb-1" data-v-79c582c0><span class="inline-block w-5 h-5 bg-purple-500 rounded-sm" data-v-79c582c0></span><span class="text-sm text-gray-700" data-v-79c582c0>High Population Density</span></div><div class="flex items-center space-x-2" data-v-79c582c0><span class="inline-block w-5 h-5 bg-purple-200 rounded-sm border border-purple-400" data-v-79c582c0></span><span class="text-sm text-gray-700" data-v-79c582c0>Low Population Density</span></div>',3)]))):x("",!0)],512),[[A,s.heatmapType]]),d.value?(l(),i("div",G,o[4]||(o[4]=[c("div",{class:"text-center"},[c("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-2 mx-auto"}),c("p",{class:"text-sm text-gray-600"},"Loading map...")],-1)]))):x("",!0)]))}}),q=B(J,[["__scopeId","data-v-79c582c0"]]),K=V("/black_circle_360x360.png");export{q as _,K as a};
